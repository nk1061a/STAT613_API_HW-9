---
title: "Untitled"
author: "STAT613_HW5"
date: "2/26/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#An investor sued his broker for lack of diversification. Below are the rates of return (in percent) for the investorâ€™s portfolio over 39 months (data from Moore, McCabe, and Craig (2017)). The average of the S&P 500 stock index for the same period was 0.95%. Does the broker perform worse than average?.
```{r}
library(tidyverse)
library(dplyr)
library(purrr)
```

```{r}
          Stockreturns <- c(-8.36,   1.63,  -2.27, -2.93,  -2.70, 
                           -2.93, -9.14, -2.64, 6.82,   -2.35, 
                           -3.58,   6.13,   7.00, -15.25, -8.66,
                           -1.03, -9.16,  -1.25, -1.22,  -10.27,
                           -5.11, -0.80,  -1.44,  1.28,  -0.65,
                            4.34,   12.22, -7.21, -0.09, 7.34, 
                            5.04,  -7.24,  -2.14, -1.01,  -1.41, 
                            12.03, -2.53,  4.33,  1.35)
         Stockreturns
```

#1) Use and show R code to find the mean of the sample data.
```{r}
mean(Stockreturns)
```
#Mean can also be generated using summary
```{r}
summary(Stockreturns)
```

#2) Use and show R code to find the standard deviation of the sample data
```{r}
sd(Stockreturns)
```

#3) Assuming a normal distribution, use and show R code to find the proportion of returns that are less than  -1.5.
#Assuming standard normal distribution: Mean=0, SD=1
```{r}
pnorm(q = -1.5, mean = 0, sd = 1)
```

#4) Assuming a normal distribution, use and show R code to find return value that is above 70% of the returns
```{r}
 qnorm(p = 0.30, mean = 0, sd = 1)
```

#5) Use and show R code to find Q1 for the data.
# Q1 = -3.255 
```{r}
quantile(Stockreturns, 0.25)
```

#About 25% of the data falls below Q1 and 75% above Q1.
```{r}
quantile(Stockreturns, probs = c(0.25))
```

#6) Explore the data by producing and examining a boxplot and checking for normality.
```{r}
boxplot(Stockreturns)
```
#Analysis of Boxplot: 
#There seem obvious outliers at the top and one at the bottom. 

#Analysis of a Histogram:
#The graph is unimodal with approximate normal distribution.
```{r}
hist(Stockreturns)
```

#Analysis of qqplot: 
#The data seems to fall close to the line in the center. However, 
#it begins to deviate and move away from the line especially
#towards and at the ends (top and bottom) indicating overall 
#somewhat approximate normality. 
```{r}
qqnorm(Stockreturns)
qqline(Stockreturns)
```

#7) State the appropriate null and alternative hypothesis required for the appropriate t test.
#ANSWER): 
#Null is average score is 0.0095, Alternative is > 0.0095
# H(0) :  mu = 0.0095 (Null Hypothesis)
# H(A) :  mu > 0.0095 (Alternative Hypothesis)

#We will reject the Null Hypothesis if a calculated
#p-value is less than a pre-set alpha value (normally .05)


#8) Use and show R code that will output the needed p value and confidence interval to determine if the null hypothesis should be rejected.
```{r}
 t.test(Stockreturns,mu=0.0095, alternative = "greater", conf.level = .95)
```

#summary and conclusion (P-value):
#since p = 0.8783> .05, we fail to reject the null hypothesis
#i.e. it is concluded that the average score for the portfolio
#is 0.95%. 

#(Confidence Interval):
#since 0.0095 (the null hypothesized vale) is between the confidence interval, i.e. -2.738401 and Infinity, it also concludes that 
#we fail to reject to null hypothesis

#9) Now answer the question originally stated.  Does the broker perform worse than average? (Explain or justify in two or three sentences).
#ANSWER): 
#The above calculations/results of p-vales and confidence interval,
#both lead to the conclusion of failure to reject Null and 
#confirming that the broker performs the same as the average 
#of the S&P500 stock(neither below or above it).  
